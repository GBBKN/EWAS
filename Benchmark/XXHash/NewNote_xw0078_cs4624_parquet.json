{"paragraphs":[{"text":"%spark\nimport scala.math.pow\nimport java.lang.System.nanoTime\nimport org.apache.spark.sql.Row\n// pick random url\nval df2 = spark.read.format(\"parquet\").load(\"D:/cityhash.parquet.gzip\")\nval test1 = df2.select(\"originalUrl\").sample(false, 0.2).take(1000)\nval df = spark.read.format(\"parquet\").load(\"D:/cityhash.parquet.gzip\")","user":"anonymous","dateUpdated":"2020-04-25T15:39:17-0400","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1587839251440_-1032816743","id":"20200425-112545_869859629","dateCreated":"2020-04-25T14:27:31-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:279","dateFinished":"2020-04-25T15:39:18-0400","dateStarted":"2020-04-25T15:39:17-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import scala.math.pow\r\nimport java.lang.System.nanoTime\r\nimport org.apache.spark.sql.Row\r\ndf2: org.apache.spark.sql.DataFrame = [key: string, surtUrl: string ... 16 more fields]\r\ntest1: Array[org.apache.spark.sql.Row] = Array([http://1023blakefm.com/tags/dead/feed/], [http://1173262.r.msn.com/?ld=7vBq0A3Z2dGg_uJ-DZn0eZvTVUCUxuWIPyemBv6vqzlETLkt81oRPjwLcKULzo15E1ey544lXUtUWxzsriHHj-XVEU4szFGE4IILnNcUmeMF5owZXxZMIX_36g4_WmKADK6pwa9Q&u=www.spokeo.com%2Fis-he-cheating%3Fg%3Demail_bc_D327173], [http://1190kex.iheart.com/articles/politics-104707/house-passes-bill-4210-to-let-12446884/], [http://17hmr.net/index.php?topic=11992.msg163026], [http://182.18.31.175/211/link.asp?page=/article/211], [http://3dgameman.com/reviews/1338/bitfenix-shinobi-xl-case], [http://3hive.com/2005/03/31/john-vander..."}]}},{"text":"%spark\n//df2.select(\"originalUrl\").sample(false,1.0*5/60000).limit(1).show(false)\n\nvar a = 0.0\nfor(w <- test1){\n// URL searching\nsqlContext.clearCache() // clear memory cache\nval t0: Long = nanoTime\n//Benchmark: loading and searching 1 url from the file\nval filtered = df.filter($\"originalUrl\" === w.toString) \nval t1: Long = nanoTime\nval timecost = (t1 - t0).toDouble / pow(10, 9)\n// println(\"Total Time (seconds):\"+timecost.toString)\na = a + timecost\n}\nprintln(\"Average Time (seconds):\"+(a/1000).toString)\n\n\n","user":"anonymous","dateUpdated":"2020-04-25T15:39:30-0400","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Average Time (seconds):0.005748173399999997\r\na: Double = 5.748173399999997\n"}]},"apps":[],"jobName":"paragraph_1587839251442_1316918121","id":"20200420-190207_12661969","dateCreated":"2020-04-25T14:27:31-0400","dateStarted":"2020-04-25T15:39:30-0400","dateFinished":"2020-04-25T15:39:37-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:281"},{"text":"%spark\nval df = spark.read.format(\"parquet\").load(\"D:/cityhash.parquet.gzip\")\ndf.printSchema()\n","user":"anonymous","dateUpdated":"2020-04-25T15:45:07-0400","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1587839251450_412248354","id":"20200420-190524_959622410","dateCreated":"2020-04-25T14:27:31-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:284","dateFinished":"2020-04-25T15:45:08-0400","dateStarted":"2020-04-25T15:45:07-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- key: string (nullable = true)\n |-- surtUrl: string (nullable = true)\n |-- timestamp: string (nullable = true)\n |-- originalUrl: string (nullable = true)\n |-- mime: string (nullable = true)\n |-- status: string (nullable = true)\n |-- digest: string (nullable = true)\n |-- redirectUrl: string (nullable = true)\n |-- meta: string (nullable = true)\n |-- contentLength: long (nullable = true)\n |-- offset: long (nullable = true)\n |-- filename: string (nullable = true)\n |-- allheader: string (nullable = true)\n |-- payload: string (nullable = true)\n |-- Unnamed: 0: string (nullable = true)\n |-- CleanedURL: string (nullable = true)\n |-- hash64: string (nullable = true)\n |-- hash32: string (nullable = true)\n\r\ndf: org.apache.spark.sql.DataFrame = [key: string, surtUrl: string ... 16 more fields]\n"}]}},{"text":"%spark\n","user":"anonymous","dateUpdated":"2020-04-25T15:45:07-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1587843907359_1587470309","id":"20200425-154507_1877197357","dateCreated":"2020-04-25T15:45:07-0400","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4134"}],"name":"xw0078/cs4624_parquet","id":"2F7MZYUW8","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}