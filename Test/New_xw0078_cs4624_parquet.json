{"paragraphs":[{"text":"%spark\n// please check column type to avoid the error message: Parquet type not supported: INT64 (UINT_64)\nval df = spark.read.format(\"parquet\").load(\"D:/spookyHash.parquet.gzip\")","user":"anonymous","dateUpdated":"2020-04-25T11:16:34-0400","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df: org.apache.spark.sql.DataFrame = [key: string, surtUrl: string ... 17 more fields]\n"}]},"apps":[],"jobName":"paragraph_1587784668446_516332102","id":"20200420-185032_1068662708","dateCreated":"2020-04-24T23:17:48-0400","dateStarted":"2020-04-25T11:16:35-0400","dateFinished":"2020-04-25T11:16:40-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1177"},{"text":"%spark\nval df = spark.read.format(\"parquet\").load(\"D:/spookyHash.parquet.gzip\")\ndf.printSchema()\n","user":"anonymous","dateUpdated":"2020-04-25T12:31:33-0400","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- key: string (nullable = true)\n |-- surtUrl: string (nullable = true)\n |-- timestamp: string (nullable = true)\n |-- originalUrl: string (nullable = true)\n |-- mime: string (nullable = true)\n |-- status: string (nullable = true)\n |-- digest: string (nullable = true)\n |-- redirectUrl: string (nullable = true)\n |-- meta: string (nullable = true)\n |-- contentLength: long (nullable = true)\n |-- offset: long (nullable = true)\n |-- filename: string (nullable = true)\n |-- allheader: string (nullable = true)\n |-- payload: string (nullable = true)\n |-- Unnamed: 0: string (nullable = true)\n |-- Cleaned Original URL: string (nullable = true)\n |-- hash128: string (nullable = true)\n |-- hash64: string (nullable = true)\n |-- hash32: string (nullable = true)\n\r\ndf: org.apache.spark.sql.DataFrame = [key: string, surtUrl: string ... 17 more fields]\n"}]},"apps":[],"jobName":"paragraph_1587784668460_-1871674785","id":"20200420-185322_1295256400","dateCreated":"2020-04-24T23:17:48-0400","dateStarted":"2020-04-25T12:31:33-0400","dateFinished":"2020-04-25T12:31:49-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1178"},{"text":"%spark\n","user":"anonymous","dateUpdated":"2020-04-25T11:25:45-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1587828345182_-809598573","id":"20200425-112545_869859629","dateCreated":"2020-04-25T11:25:45-0400","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:1179"},{"text":"%spark\n","user":"anonymous","dateUpdated":"2020-04-25T12:04:11-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1587829294561_1252758554","id":"20200425-114134_413566187","dateCreated":"2020-04-25T11:41:34-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2441"},{"text":"%spark\n//df2.select(\"originalUrl\").sample(false,1.0*5/60000).limit(1).show(false)\n\nimport scala.math.pow\nimport java.lang.System.nanoTime\nimport org.apache.spark.sql.Row\n\nvar a = 0.0\nfor(w <- 0 to 10){\n// pick one random url\nval df2 = spark.read.format(\"parquet\").load(\"D:/spookyHash.parquet.gzip\")\nval test1 = df2.select(\"hash64\").sample(false,1.0*5/60745).first().get(0)\nprintln(test1)\n// URL searching\nsqlContext.clearCache() // clear memory cache\nval t0: Long = nanoTime\n//Benchmark: loading and searching 1 url from the file\nval df = spark.read.format(\"parquet\").load(\"D:/spookyHash.parquet.gzip\")\nval filtered = df.filter($\"hash64\" === test1) \nval t1: Long = nanoTime\nval timecost = (t1 - t0).toDouble / pow(10, 9)\nprintln(\"Total Time (seconds):\"+timecost.toString)\na = a + timecost\n}\nprintln(\"Average Time (seconds):\"+(a/10).toString)\n","user":"anonymous","dateUpdated":"2020-04-25T12:35:51-0400","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"783646514024509451\r\nTotal Time (seconds):0.1198257\r\n7081192198335832897\r\nTotal Time (seconds):0.1099967\r\n16324539974482581477\r\nTotal Time (seconds):0.1615198\r\n6795138173401639195\r\nTotal Time (seconds):0.1889795\r\n53265151816301172\r\nTotal Time (seconds):0.226751\r\n8315851175033782695\r\nTotal Time (seconds):0.1499413\r\n7028562126836160547\r\nTotal Time (seconds):0.1499718\r\n137243966565320074\r\nTotal Time (seconds):0.1724152\r\n15514118521115410441\r\nTotal Time (seconds):0.1512713\r\n16394136884748909780\r\nTotal Time (seconds):0.2949645\r\n1335316496578362901\r\nTotal Time (seconds):0.1610319\r\nAverage Time (seconds):0.18866687\r\nimport scala.math.pow\r\nimport java.lang.System.nanoTime\r\nimport org.apache.spark.sql.Row\r\na: Double = 1.8866687\n"}]},"apps":[],"jobName":"paragraph_1587784668461_-1781625695","id":"20200420-190207_12661969","dateCreated":"2020-04-24T23:17:48-0400","dateStarted":"2020-04-25T12:35:51-0400","dateFinished":"2020-04-25T12:35:56-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1180"},{"text":"%spark\n","user":"anonymous","dateUpdated":"2020-04-24T23:19:47-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1587784787772_-259867272","id":"20200424-231947_1847138377","dateCreated":"2020-04-24T23:19:47-0400","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:1181"},{"text":"%spark\n// URL searching\nimport scala.math.pow\nimport java.lang.System.nanoTime\nsqlContext.clearCache() // clear memory cache\nval t0: Long = nanoTime\n//Benchmark: loading and searching 1 url from the file\nval df = spark.read.format(\"parquet\").load(\"D:/spookyHash.parquet.gzip\")\nval filtered = df.filter($\"originalUrl\" === \"http://redriverradio.org/post/when-cinnamon-spice-not-so-nice-great-danish-debate\") \nval t1: Long = nanoTime\nval timecost = (t1 - t0).toDouble / pow(10, 9)\nprintln(\"Total Time (seconds):\"+timecost.toString)","user":"anonymous","dateUpdated":"2020-04-25T12:02:53-0400","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Total Time (seconds):0.1436157\r\nimport scala.math.pow\r\nimport java.lang.System.nanoTime\r\nt0: Long = 328554795365700\r\ndf: org.apache.spark.sql.DataFrame = [key: string, surtUrl: string ... 17 more fields]\r\nfiltered: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [key: string, surtUrl: string ... 17 more fields]\r\nt1: Long = 328554938981400\r\ntimecost: Double = 0.1436157\n"}]},"apps":[],"jobName":"paragraph_1587784668462_-80242285","id":"20200420-185759_280020687","dateCreated":"2020-04-24T23:17:48-0400","dateStarted":"2020-04-25T12:02:53-0400","dateFinished":"2020-04-25T12:02:53-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1182"},{"text":"%spark\n","user":"anonymous","dateUpdated":"2020-04-24T23:17:48-0400","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1587784668463_-773180569","id":"20200420-190524_959622410","dateCreated":"2020-04-24T23:17:48-0400","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1183"}],"name":"xw0078/cs4624_parquet","id":"2F6XWYJTB","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}