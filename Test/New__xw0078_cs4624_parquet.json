{"paragraphs":[{"text":"%spark\nimport scala.math.pow\nimport java.lang.System.nanoTime\nimport org.apache.spark.sql.Row\n// pick random url\nval df2 = spark.read.format(\"parquet\").load(\"D:/xxhash3264.parquet.gzip\")\nval test1 = df2.select(\"originalUrl\").sample(false, 0.2).take(100)\nval df = spark.read.format(\"parquet\").load(\"D:/xxhash3264.parquet.gzip\")","user":"anonymous","dateUpdated":"2020-04-25T15:16:34-0400","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1587839251440_-1032816743","id":"20200425-112545_869859629","dateCreated":"2020-04-25T14:27:31-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:279","dateFinished":"2020-04-25T15:18:32-0400","dateStarted":"2020-04-25T15:16:34-0400","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import scala.math.pow\r\nimport java.lang.System.nanoTime\r\nimport org.apache.spark.sql.Row\r\ndf2: org.apache.spark.sql.DataFrame = [key: string, surtUrl: string ... 16 more fields]\r\ntest1: Array[org.apache.spark.sql.Row] = Array([http://1023blakefm.com/tags/dead/feed/], [http://1057thehawk.com/remembering-superstorm-sandy-one-year-ago-today/], [http://1837.d045.com/], [http://2006.confex.com/uicc/wctoh/techprogram/P7715.HTM], [http://200mail.com/yalls/], [http://209.157.64.200/focus/f-news/742498/posts], [http://2278.k798.com/], [http://26plus-zeichen.de/fonts/winheim/], [http://2dopeboyz.com/2012/01/04/tony-touch-the-best-toca-tuesdays-freestyles-of-2011-mixtape/], [http://2perc.blog.hu/tags/%C3%A1llatok?token=4f115cc00c4b0c59d337d902451b4640], [http://320volt.com/kendimiz-yapalim-proje-a..."}]}},{"text":"%spark\n//df2.select(\"originalUrl\").sample(false,1.0*5/60000).limit(1).show(false)\n\nvar a = 0.0\nfor(w <- test1){\n// URL searching\nsqlContext.clearCache() // clear memory cache\nval t0: Long = nanoTime\n//Benchmark: loading and searching 1 url from the file\nval filtered = df.filter($\"originalUrl\" === w.toString) \nval t1: Long = nanoTime\nval timecost = (t1 - t0).toDouble / pow(10, 9)\n// println(\"Total Time (seconds):\"+timecost.toString)\na = a + timecost\n}\nprintln(\"Average Time (seconds):\"+(a/100).toString)\n\n\n","user":"anonymous","dateUpdated":"2020-04-25T15:16:40-0400","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Average Time (seconds):0.09473420399999999\r\na: Double = 9.473420399999998\n"}]},"apps":[],"jobName":"paragraph_1587839251442_1316918121","id":"20200420-190207_12661969","dateCreated":"2020-04-25T14:27:31-0400","dateStarted":"2020-04-25T15:16:51-0400","dateFinished":"2020-04-25T15:18:51-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:281"},{"text":"%spark\n","user":"anonymous","dateUpdated":"2020-04-25T14:28:28-0400","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1587839251450_412248354","id":"20200420-190524_959622410","dateCreated":"2020-04-25T14:27:31-0400","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:284"}],"name":"xw0078/cs4624_parquet","id":"2F7MZYUW8","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}